### Install packages

```{r}
install.packages(c("stats", "tidyverse", "readr", "broom", "ggplot2", "lmtest"))
```

### Import libraries

```{r}
library(readr)
library(tidyverse)
library(ggplot2)
library(broom)
library(tidyverse)
library(stats)
```

### Read the data

```{r}
data <- read_csv("cost-of-living.csv")
data <- data[! is.na(data$x54) & ! is.na(data$x43), ]
head(data)

```

### Structure of the data

```{r}
head(data)
```

### Needed data

```{r}
salary <- data$x54
gasoline <- data$x43
merge_list <- map2(data$x54, data$x43, ~ c(.x, .y))
```

### Plotting data

```{r}
hist(salary, col="darkred", ,border="white")
hist(gasoline, col="darkred", ,border="white")
x <- map_dbl(merge_list, 2)
y <- map_dbl(merge_list, 1)
```

### Mean values

```{r}
salary_mean <- mean(salary)
gasoline_mean <- mean(gasoline)
```

### Data researching

```{r}
x <- map_dbl(merge_list, 1)
y <- map_dbl(merge_list, 2)
sorted_x <- sort(x)
sorted_y <- y[order(x)]
merge_list <- map2(sorted_x, sorted_y, ~ c(.x, .y))
```

### Grouping

```{r}
count <- 0
grouped_list <- list()
salary_sum <- 0
gasonile_sum <- 0
for(tuple in merge_list) {
  count <- count + 1
  salary_sum <- salary_sum + tuple[[1]]
  gasonile_sum <- gasonile_sum + tuple[[2]]
  if (count == 100) {
    grouped_list[[length(grouped_list) + 1]] <- list(salary_sum / 100, gasonile_sum / 100)
    count <- 0
    salary_sum <- 0
    gasonile_sum <- 0
  }
}
grouped_list[[length(grouped_list) + 1]] <- list(salary_sum / count, gasonile_sum / count)
grouped_list
```

```{r}
x <- map_dbl(grouped_list, 1)
y <- map_dbl(grouped_list, 2)
linear_model <- lm(y ~ x)
plot(x, y, pch=16, col="blue")
abline(linear_model, col = "red")
```

```{r}
summary(linear_model)
slope <- coef(linear_model)[2]
print(slope)
```
